
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <title>CMake Module · HonKit</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 4.0.8">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="heimdall-sbom-manual.html" />
    
    
    <link rel="prev" href="architecture.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="architecture.html">
            
                <a href="architecture.html">
            
                    
                    Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3" data-path="cmake_module.html">
            
                <a href="cmake_module.html">
            
                    
                    CMake Module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="heimdall-sbom-manual.html">
            
                <a href="heimdall-sbom-manual.html">
            
                    
                    Heimdall SBOM Manual
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="heimdall-validate-manual.html">
            
                <a href="heimdall-validate-manual.html">
            
                    
                    Heimdall Validate Manual
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="ada_SBOM.html">
            
                <a href="ada_SBOM.html">
            
                    
                    Ada SBOM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="ci-workflow.md">
            
                <span>
            
                    
                    CI Workflow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="heimdall-developers-guide.md">
            
                <span>
            
                    
                    Heimdall Developers Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="heimdall-users-guide.md">
            
                <span>
            
                    
                    Heimdall Users Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="llvm-compatibility.html">
            
                <a href="llvm-compatibility.html">
            
                    
                    LLVM Compatibility
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="multi-standard-support.html">
            
                <a href="multi-standard-support.html">
            
                    
                    Multi-Standard Support
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="sbom_validation_guide.html">
            
                <a href="sbom_validation_guide.html">
            
                    
                    SBOM Validation Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="setup_usage.html">
            
                <a href="setup_usage.html">
            
                    
                    Setup Usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="testing-heimdall.html">
            
                <a href="testing-heimdall.html">
            
                    
                    Testing Heimdall
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="usage.html">
            
                <a href="usage.html">
            
                    
                    Usage
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >CMake Module</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="heimdall-cmake-module---usage-guide">Heimdall CMake Module - Usage Guide</h1>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#overview">Overview</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#quick-start">Quick Start</a></li>
<li><a href="#basic-usage">Basic Usage</a></li>
<li><a href="#advanced-configuration">Advanced Configuration</a></li>
<li><a href="#supported-formats">Supported Formats</a></li>
<li><a href="#linker-integration">Linker Integration</a></li>
<li><a href="#examples">Examples</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#integration">Integration</a></li>
</ol>
<h2 id="overview">Overview</h2>
<p>The Heimdall CMake module provides seamless integration of SBOM (Software Bill of Materials) generation into CMake-based build systems. It automatically detects available linkers and plugins, configures the build process, and generates SBOMs as part of your normal build workflow.</p>
<h3 id="key-features">Key Features</h3>
<ul>
<li><strong>Automatic Integration</strong>: SBOM generation integrated into your build process</li>
<li><strong>Multi-Linker Support</strong>: Works with LLVM LLD and GNU Gold linkers</li>
<li><strong>Multi-Format Support</strong>: SPDX (2.3, 3.0, 3.0.1) and CycloneDX (1.4, 1.5, 1.6)</li>
<li><strong>Cross-Platform</strong>: Works on Linux and macOS</li>
<li><strong>Zero Configuration</strong>: Sensible defaults for immediate use</li>
<li><strong>Flexible Configuration</strong>: Extensive options for customization</li>
</ul>
<h3 id="supported-platforms">Supported Platforms</h3>
<table>
<thead>
<tr>
<th>Platform</th>
<th>LLD Support</th>
<th>Gold Support</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Linux</td>
<td>✅ Full</td>
<td>✅ Full</td>
<td>Gold requires elfutils</td>
</tr>
<tr>
<td>macOS</td>
<td>✅ Full</td>
<td>❌ None</td>
<td>Gold not available</td>
</tr>
<tr>
<td>Windows</td>
<td>✅ Full</td>
<td>❌ None</td>
<td>Gold not available</td>
</tr>
</tbody>
</table>
<h2 id="installation">Installation</h2>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>CMake 3.16 or later</li>
<li>C++17 or later compiler</li>
<li>Heimdall installation (see <a href="heimdall-users-guide.md">Heimdall Installation Guide</a>)</li>
</ul>
<h3 id="installing-the-cmake-module">Installing the CMake Module</h3>
<h4 id="option-1-copy-to-your-project">Option 1: Copy to Your Project</h4>
<pre><code class="lang-bash"><span class="hljs-comment"># Copy the cmake directory to your project</span>
cp -r /path/to/heimdall/cmake ./cmake

<span class="hljs-comment"># Or clone the repository and copy</span>
git <span class="hljs-built_in">clone</span> https://github.com/Heimdall-SBOM/heimdall.git
cp -r heimdall/cmake ./cmake
</code></pre>
<h4 id="option-2-use-as-external-project">Option 2: Use as External Project</h4>
<pre><code class="lang-cmake"><span class="hljs-comment"># In your CMakeLists.txt</span>
<span class="hljs-keyword">include</span>(FetchContent)
FetchContent_Declare(
    heimdall
    GIT_REPOSITORY https://github.com/Heimdall-SBOM/heimdall.git
    GIT_TAG main
)
FetchContent_MakeAvailable(heimdall)
</code></pre>
<h4 id="option-3-system-installation">Option 3: System Installation</h4>
<pre><code class="lang-bash"><span class="hljs-comment"># Install to system CMake modules directory</span>
sudo cp -r /path/to/heimdall/cmake/* /usr/share/cmake/Modules/
</code></pre>
<h3 id="verifying-installation">Verifying Installation</h3>
<pre><code class="lang-cmake"><span class="hljs-comment"># Test in your CMakeLists.txt</span>
<span class="hljs-keyword">find_package</span>(Heimdall REQUIRED)
<span class="hljs-keyword">message</span>(STATUS <span class="hljs-string">"Heimdall found: ${HEIMDALL_FOUND}"</span>)
<span class="hljs-keyword">message</span>(STATUS <span class="hljs-string">"LLD plugin: ${HEIMDALL_LLD_PLUGIN}"</span>)
<span class="hljs-keyword">message</span>(STATUS <span class="hljs-string">"Gold plugin: ${HEIMDALL_GOLD_PLUGIN}"</span>)
</code></pre>
<h2 id="quick-start">Quick Start</h2>
<h3 id="basic-setup">Basic Setup</h3>
<ol>
<li><p><strong>Add the module to your project:</strong></p>
<pre><code class="lang-cmake"><span class="hljs-comment"># CMakeLists.txt</span>
<span class="hljs-keyword">cmake_minimum_required</span>(VERSION <span class="hljs-number">3.16</span>)
<span class="hljs-keyword">project</span>(MyProject)

<span class="hljs-comment"># Add Heimdall cmake modules to path</span>
<span class="hljs-keyword">list</span>(APPEND CMAKE_MODULE_PATH <span class="hljs-string">"${CMAKE_SOURCE_DIR}/cmake"</span>)

<span class="hljs-comment"># Find and include Heimdall</span>
<span class="hljs-keyword">find_package</span>(Heimdall REQUIRED)
<span class="hljs-keyword">include</span>(HeimdallSBOM)
</code></pre>
</li>
<li><p><strong>Create your target:</strong></p>
<pre><code class="lang-cmake"><span class="hljs-keyword">add_executable</span>(myapp main.cpp)
</code></pre>
</li>
<li><p><strong>Enable SBOM generation:</strong></p>
<pre><code class="lang-cmake">heimdall_enable_sbom(myapp)
</code></pre>
</li>
<li><p><strong>Build your project:</strong></p>
<pre><code class="lang-bash">mkdir build &amp;&amp; <span class="hljs-built_in">cd</span> build
cmake ..
make
</code></pre>
</li>
</ol>
<p>The SBOM will be automatically generated during the build process!</p>
<h3 id="generated-files">Generated Files</h3>
<p>After building, you'll find:</p>
<ul>
<li><code>build/sbom/myapp.spdx</code> - SPDX format SBOM</li>
<li><code>build/sbom/myapp.cyclonedx.json</code> - CycloneDX format SBOM (if enabled)</li>
</ul>
<h2 id="basic-usage">Basic Usage</h2>
<h3 id="simple-sbom-generation">Simple SBOM Generation</h3>
<pre><code class="lang-cmake"><span class="hljs-comment"># Enable SBOM generation with defaults</span>
heimdall_enable_sbom(myapp)
</code></pre>
<p><strong>Default behavior:</strong></p>
<ul>
<li>Uses SPDX 2.3 format</li>
<li>Outputs to <code>${CMAKE_BINARY_DIR}/sbom/</code></li>
<li>Uses automatic linker detection</li>
<li>Includes all dependencies</li>
</ul>
<h3 id="specify-format">Specify Format</h3>
<pre><code class="lang-cmake"><span class="hljs-comment"># Generate CycloneDX SBOM</span>
heimdall_enable_sbom(myapp FORMAT cyclonedx-<span class="hljs-number">1.6</span>)

<span class="hljs-comment"># Generate SPDX 3.0 JSON</span>
heimdall_enable_sbom(myapp FORMAT spdx-<span class="hljs-number">3.0</span>)

<span class="hljs-comment"># Generate SPDX 2.3 tag-value</span>
heimdall_enable_sbom(myapp FORMAT spdx-<span class="hljs-number">2.3</span>)
</code></pre>
<h3 id="specify-output">Specify Output</h3>
<pre><code class="lang-cmake"><span class="hljs-comment"># Custom output path</span>
heimdall_enable_sbom(myapp 
    FORMAT cyclonedx-<span class="hljs-number">1.6</span>
    OUTPUT myapp.cyclonedx.json
)

<span class="hljs-comment"># Output to specific directory</span>
heimdall_enable_sbom(myapp 
    FORMAT spdx-<span class="hljs-number">3.0</span>
    OUTPUT <span class="hljs-variable">${CMAKE_SOURCE_DIR}</span>/docs/myapp.spdx.json
)
</code></pre>
<h3 id="multiple-formats">Multiple Formats</h3>
<pre><code class="lang-cmake"><span class="hljs-comment"># Generate multiple formats</span>
heimdall_enable_sbom(myapp FORMAT spdx-<span class="hljs-number">2.3</span>)
heimdall_enable_sbom(myapp FORMAT cyclonedx-<span class="hljs-number">1.6</span>)
heimdall_enable_sbom(myapp FORMAT spdx-<span class="hljs-number">3.0</span>)
</code></pre>
<h2 id="advanced-configuration">Advanced Configuration</h2>
<h3 id="global-configuration">Global Configuration</h3>
<p>Set global defaults in your <code>CMakeLists.txt</code>:</p>
<pre><code class="lang-cmake"><span class="hljs-comment"># Global SBOM configuration</span>
<span class="hljs-keyword">set</span>(HEIMDALL_SBOM_FORMAT <span class="hljs-string">"cyclonedx-1.6"</span> CACHE <span class="hljs-keyword">STRING</span> <span class="hljs-string">"Default SBOM format"</span>)
<span class="hljs-keyword">set</span>(HEIMDALL_SBOM_OUTPUT_DIR <span class="hljs-string">"${CMAKE_BINARY_DIR}/sboms"</span> CACHE PATH <span class="hljs-string">"SBOM output directory"</span>)
<span class="hljs-keyword">set</span>(HEIMDALL_SBOM_VERBOSE <span class="hljs-keyword">ON</span> CACHE BOOL <span class="hljs-string">"Enable verbose SBOM generation"</span>)
<span class="hljs-keyword">set</span>(HEIMDALL_SBOM_INCLUDE_SYSTEM_LIBS <span class="hljs-keyword">OFF</span> CACHE BOOL <span class="hljs-string">"Include system libraries"</span>)

<span class="hljs-comment"># Linker preferences</span>
<span class="hljs-keyword">set</span>(HEIMDALL_PREFERRED_LINKER <span class="hljs-string">"auto"</span> CACHE <span class="hljs-keyword">STRING</span> <span class="hljs-string">"Preferred linker (lld, gold, auto)"</span>)
</code></pre>
<h3 id="target-specific-configuration">Target-Specific Configuration</h3>
<pre><code class="lang-cmake"><span class="hljs-comment"># Configure specific target</span>
<span class="hljs-keyword">set_target_properties</span>(myapp PROPERTIES
    HEIMDALL_SBOM_FORMAT <span class="hljs-string">"cyclonedx-1.6"</span>
    HEIMDALL_SBOM_OUTPUT <span class="hljs-string">"myapp.cyclonedx.json"</span>
    HEIMDALL_SBOM_VERBOSE <span class="hljs-keyword">ON</span>
    HEIMDALL_SBOM_INCLUDE_SYSTEM_LIBS <span class="hljs-keyword">ON</span>
)

heimdall_enable_sbom(myapp)
</code></pre>
<h3 id="advanced-options">Advanced Options</h3>
<pre><code class="lang-cmake"><span class="hljs-comment"># Full configuration example</span>
heimdall_enable_sbom(myapp
    FORMAT cyclonedx-<span class="hljs-number">1.6</span>
    OUTPUT myapp.cyclonedx.json
    VERBOSE <span class="hljs-keyword">ON</span>
    INCLUDE_SYSTEM_LIBS <span class="hljs-keyword">OFF</span>
    LINKER lld  <span class="hljs-comment"># Force LLD linker</span>
)
</code></pre>
<h3 id="conditional-sbom-generation">Conditional SBOM Generation</h3>
<pre><code class="lang-cmake"><span class="hljs-comment"># Only generate SBOM in Release builds</span>
<span class="hljs-keyword">if</span>(CMAKE_BUILD_TYPE <span class="hljs-keyword">STREQUAL</span> <span class="hljs-string">"Release"</span>)
    heimdall_enable_sbom(myapp FORMAT cyclonedx-<span class="hljs-number">1.6</span>)
<span class="hljs-keyword">endif</span>()

<span class="hljs-comment"># Generate different formats for different build types</span>
<span class="hljs-keyword">if</span>(CMAKE_BUILD_TYPE <span class="hljs-keyword">STREQUAL</span> <span class="hljs-string">"Debug"</span>)
    heimdall_enable_sbom(myapp FORMAT spdx-<span class="hljs-number">2.3</span> VERBOSE <span class="hljs-keyword">ON</span>)
<span class="hljs-keyword">else</span>()
    heimdall_enable_sbom(myapp FORMAT cyclonedx-<span class="hljs-number">1.6</span>)
<span class="hljs-keyword">endif</span>()
</code></pre>
<h2 id="supported-formats">Supported Formats</h2>
<h3 id="cyclonedx-formats">CycloneDX Formats</h3>
<table>
<thead>
<tr>
<th>Version</th>
<th>Format</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.4</td>
<td>JSON</td>
<td>Basic component structure</td>
</tr>
<tr>
<td>1.5</td>
<td>JSON</td>
<td>Enhanced validation</td>
</tr>
<tr>
<td>1.6</td>
<td>JSON</td>
<td>Latest features (default)</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code class="lang-cmake">heimdall_enable_sbom(myapp FORMAT cyclonedx-<span class="hljs-number">1.6</span>)
</code></pre>
<h3 id="spdx-formats">SPDX Formats</h3>
<table>
<thead>
<tr>
<th>Version</th>
<th>Format</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>2.3</td>
<td>Tag-value</td>
<td>Traditional SPDX format</td>
</tr>
<tr>
<td>3.0</td>
<td>JSON</td>
<td>Modern JSON format</td>
</tr>
<tr>
<td>3.0.1</td>
<td>JSON</td>
<td>Latest SPDX JSON</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<pre><code class="lang-cmake"><span class="hljs-comment"># Tag-value format</span>
heimdall_enable_sbom(myapp FORMAT spdx-<span class="hljs-number">2.3</span>)

<span class="hljs-comment"># JSON format</span>
heimdall_enable_sbom(myapp FORMAT spdx-<span class="hljs-number">3.0</span>)
</code></pre>
<h2 id="linker-integration">Linker Integration</h2>
<h3 id="automatic-detection">Automatic Detection</h3>
<p>The module automatically detects available linkers:</p>
<pre><code class="lang-cmake"><span class="hljs-comment"># Check what's available</span>
<span class="hljs-keyword">message</span>(STATUS <span class="hljs-string">"LLD available: ${HEIMDALL_LLD_AVAILABLE}"</span>)
<span class="hljs-keyword">message</span>(STATUS <span class="hljs-string">"Gold available: ${HEIMDALL_GOLD_AVAILABLE}"</span>)
</code></pre>
<h3 id="manual-linker-selection">Manual Linker Selection</h3>
<pre><code class="lang-cmake"><span class="hljs-comment"># Force specific linker</span>
heimdall_enable_sbom(myapp LINKER lld)
heimdall_enable_sbom(myapp LINKER gold)
heimdall_enable_sbom(myapp LINKER auto)  <span class="hljs-comment"># Default</span>
</code></pre>
<h3 id="linker-specific-configuration">Linker-Specific Configuration</h3>
<h4 id="lld-configuration">LLD Configuration</h4>
<pre><code class="lang-cmake"><span class="hljs-comment"># LLD-specific options</span>
<span class="hljs-keyword">set_target_properties</span>(myapp PROPERTIES
    HEIMDALL_LLD_VERBOSE <span class="hljs-keyword">ON</span>
    HEIMDALL_LLD_DEBUG_INFO <span class="hljs-keyword">ON</span>
)

heimdall_enable_sbom(myapp LINKER lld)
</code></pre>
<h4 id="gold-configuration">Gold Configuration</h4>
<pre><code class="lang-cmake"><span class="hljs-comment"># Gold-specific options (Linux only)</span>
<span class="hljs-keyword">set_target_properties</span>(myapp PROPERTIES
    HEIMDALL_GOLD_PLUGIN_OPTIONS <span class="hljs-string">"--plugin-opt=verbose"</span>
)

heimdall_enable_sbom(myapp LINKER gold)
</code></pre>
<h2 id="examples">Examples</h2>
<h3 id="basic-examples">Basic Examples</h3>
<h4 id="simple-application">Simple Application</h4>
<pre><code class="lang-cmake"><span class="hljs-comment"># CMakeLists.txt</span>
<span class="hljs-keyword">cmake_minimum_required</span>(VERSION <span class="hljs-number">3.16</span>)
<span class="hljs-keyword">project</span>(SimpleApp)

<span class="hljs-keyword">list</span>(APPEND CMAKE_MODULE_PATH <span class="hljs-string">"${CMAKE_SOURCE_DIR}/cmake"</span>)
<span class="hljs-keyword">find_package</span>(Heimdall REQUIRED)
<span class="hljs-keyword">include</span>(HeimdallSBOM)

<span class="hljs-keyword">add_executable</span>(simple_app main.cpp)
heimdall_enable_sbom(simple_app)
</code></pre>
<h4 id="library-with-sbom">Library with SBOM</h4>
<pre><code class="lang-cmake"><span class="hljs-comment"># CMakeLists.txt</span>
<span class="hljs-keyword">cmake_minimum_required</span>(VERSION <span class="hljs-number">3.16</span>)
<span class="hljs-keyword">project</span>(MyLibrary)

<span class="hljs-keyword">list</span>(APPEND CMAKE_MODULE_PATH <span class="hljs-string">"${CMAKE_SOURCE_DIR}/cmake"</span>)
<span class="hljs-keyword">find_package</span>(Heimdall REQUIRED)
<span class="hljs-keyword">include</span>(HeimdallSBOM)

<span class="hljs-keyword">add_library</span>(mylib SHARED src/lib.cpp)
heimdall_enable_sbom(mylib FORMAT cyclonedx-<span class="hljs-number">1.6</span>)

<span class="hljs-keyword">add_executable</span>(myapp src/main.cpp)
<span class="hljs-keyword">target_link_libraries</span>(myapp mylib)
heimdall_enable_sbom(myapp FORMAT spdx-<span class="hljs-number">3.0</span>)
</code></pre>
<h3 id="advanced-examples">Advanced Examples</h3>
<h4 id="multi-format-generation">Multi-Format Generation</h4>
<pre><code class="lang-cmake"><span class="hljs-comment"># Generate multiple formats for the same target</span>
<span class="hljs-keyword">add_executable</span>(myapp main.cpp)

<span class="hljs-comment"># SPDX formats</span>
heimdall_enable_sbom(myapp FORMAT spdx-<span class="hljs-number">2.3</span> OUTPUT myapp.spdx)
heimdall_enable_sbom(myapp FORMAT spdx-<span class="hljs-number">3.0</span> OUTPUT myapp.spdx.json)

<span class="hljs-comment"># CycloneDX formats</span>
heimdall_enable_sbom(myapp FORMAT cyclonedx-<span class="hljs-number">1.4</span> OUTPUT myapp-<span class="hljs-number">1.4</span>.cdx.json)
heimdall_enable_sbom(myapp FORMAT cyclonedx-<span class="hljs-number">1.6</span> OUTPUT myapp-<span class="hljs-number">1.6</span>.cdx.json)
</code></pre>
<h4 id="conditional-generation">Conditional Generation</h4>
<pre><code class="lang-cmake"><span class="hljs-comment"># Generate different SBOMs for different build types</span>
<span class="hljs-keyword">add_executable</span>(myapp main.cpp)

<span class="hljs-keyword">if</span>(CMAKE_BUILD_TYPE <span class="hljs-keyword">STREQUAL</span> <span class="hljs-string">"Debug"</span>)
    <span class="hljs-comment"># Debug build: verbose SPDX</span>
    heimdall_enable_sbom(myapp 
        FORMAT spdx-<span class="hljs-number">2.3</span> 
        OUTPUT debug.sbom 
        VERBOSE <span class="hljs-keyword">ON</span>
    )
<span class="hljs-keyword">elseif</span>(CMAKE_BUILD_TYPE <span class="hljs-keyword">STREQUAL</span> <span class="hljs-string">"Release"</span>)
    <span class="hljs-comment"># Release build: compact CycloneDX</span>
    heimdall_enable_sbom(myapp 
        FORMAT cyclonedx-<span class="hljs-number">1.6</span> 
        OUTPUT release.cdx.json
        INCLUDE_SYSTEM_LIBS <span class="hljs-keyword">OFF</span>
    )
<span class="hljs-keyword">endif</span>()
</code></pre>
<h4 id="complex-project-structure">Complex Project Structure</h4>
<pre><code class="lang-cmake"><span class="hljs-comment"># CMakeLists.txt</span>
<span class="hljs-keyword">cmake_minimum_required</span>(VERSION <span class="hljs-number">3.16</span>)
<span class="hljs-keyword">project</span>(ComplexProject)

<span class="hljs-keyword">list</span>(APPEND CMAKE_MODULE_PATH <span class="hljs-string">"${CMAKE_SOURCE_DIR}/cmake"</span>)
<span class="hljs-keyword">find_package</span>(Heimdall REQUIRED)
<span class="hljs-keyword">include</span>(HeimdallSBOM)

<span class="hljs-comment"># Global configuration</span>
<span class="hljs-keyword">set</span>(HEIMDALL_SBOM_OUTPUT_DIR <span class="hljs-string">"${CMAKE_BINARY_DIR}/sboms"</span>)
<span class="hljs-keyword">set</span>(HEIMDALL_SBOM_VERBOSE <span class="hljs-keyword">ON</span>)

<span class="hljs-comment"># Core library</span>
<span class="hljs-keyword">add_library</span>(core SHARED src/core.cpp)
heimdall_enable_sbom(core FORMAT cyclonedx-<span class="hljs-number">1.6</span>)

<span class="hljs-comment"># Utility library</span>
<span class="hljs-keyword">add_library</span>(utils STATIC src/utils.cpp)
heimdall_enable_sbom(utils FORMAT spdx-<span class="hljs-number">2.3</span>)

<span class="hljs-comment"># Main application</span>
<span class="hljs-keyword">add_executable</span>(main src/main.cpp)
<span class="hljs-keyword">target_link_libraries</span>(main core utils)
heimdall_enable_sbom(main FORMAT spdx-<span class="hljs-number">3.0</span>)

<span class="hljs-comment"># Test executable</span>
<span class="hljs-keyword">add_executable</span>(tests src/tests.cpp)
<span class="hljs-keyword">target_link_libraries</span>(tests core utils)
heimdall_enable_sbom(tests FORMAT cyclonedx-<span class="hljs-number">1.6</span>)
</code></pre>
<h3 id="cicd-integration">CI/CD Integration</h3>
<h4 id="github-actions">GitHub Actions</h4>
<pre><code class="lang-yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">Build</span> <span class="hljs-string">with</span> <span class="hljs-string">SBOM</span>
<span class="hljs-attr">on:</span> [<span class="hljs-string">push</span>, <span class="hljs-string">pull_request</span>]

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">build:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v3</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">Dependencies</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          sudo apt-get update
          sudo apt-get install -y build-essential cmake
</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span> <span class="hljs-string">with</span> <span class="hljs-string">SBOM</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          mkdir build &amp;&amp; cd build
          cmake ..
          make -j$(nproc)
</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Upload</span> <span class="hljs-string">SBOMs</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/upload-artifact@v3</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">name:</span> <span class="hljs-string">sboms</span>
          <span class="hljs-attr">path:</span> <span class="hljs-string">build/sboms/</span>
</code></pre>
<h4 id="jenkins-pipeline">Jenkins Pipeline</h4>
<pre><code class="lang-groovy">pipeline {
    agent any

    stages {
        stage(<span class="hljs-string">'Build'</span>) {
            steps {
                sh <span class="hljs-string">'''
                    mkdir build
                    cd build
                    cmake ..
                    make -j$(nproc)
                '''</span>
            }
        }

        stage(<span class="hljs-string">'Archive SBOMs'</span>) {
            steps {
                archiveArtifacts <span class="hljs-attr">artifacts:</span> <span class="hljs-string">'build/sboms/**/*'</span>
            }
        }
    }
}
</code></pre>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="common-issues">Common Issues</h3>
<h4 id="1-heimdall-not-found">1. "Heimdall not found"</h4>
<p><strong>Problem:</strong> CMake can't find Heimdall installation</p>
<p><strong>Solutions:</strong></p>
<pre><code class="lang-cmake"><span class="hljs-comment"># Set Heimdall root path</span>
<span class="hljs-keyword">set</span>(HEIMDALL_ROOT <span class="hljs-string">"/path/to/heimdall"</span> CACHE PATH <span class="hljs-string">"Heimdall installation path"</span>)

<span class="hljs-comment"># Or set environment variable</span>
<span class="hljs-keyword">set</span>(ENV{HEIMDALL_ROOT} <span class="hljs-string">"/path/to/heimdall"</span>)
</code></pre>
<h4 id="2-no-suitable-linker-found">2. "No suitable linker found"</h4>
<p><strong>Problem:</strong> Neither LLD nor Gold is available</p>
<p><strong>Solutions:</strong></p>
<pre><code class="lang-bash"><span class="hljs-comment"># Install LLD</span>
sudo apt-get install lld  <span class="hljs-comment"># Ubuntu/Debian</span>
brew install llvm         <span class="hljs-comment"># macOS</span>

<span class="hljs-comment"># Install Gold (Linux only)</span>
sudo apt-get install binutils-gold
</code></pre>
<h4 id="3-plugin-loading-failed">3. "Plugin loading failed"</h4>
<p><strong>Problem:</strong> Heimdall plugins can't be loaded</p>
<p><strong>Solutions:</strong></p>
<pre><code class="lang-bash"><span class="hljs-comment"># Check plugin dependencies</span>
ldd /path/to/heimdall/lib/heimdall-lld.so

<span class="hljs-comment"># Check permissions</span>
chmod 755 /path/to/heimdall/lib/heimdall-lld.so

<span class="hljs-comment"># Verify plugin path</span>
ls -la /path/to/heimdall/lib/heimdall-lld.so
</code></pre>
<h4 id="4-sbom-generation-failed">4. "SBOM generation failed"</h4>
<p><strong>Problem:</strong> SBOM generation step fails</p>
<p><strong>Solutions:</strong></p>
<pre><code class="lang-cmake"><span class="hljs-comment"># Enable verbose output for debugging</span>
heimdall_enable_sbom(myapp VERBOSE <span class="hljs-keyword">ON</span>)

<span class="hljs-comment"># Check if binary exists</span>
<span class="hljs-keyword">add_custom_command</span>(<span class="hljs-keyword">TARGET</span> myapp POST_BUILD
    <span class="hljs-keyword">COMMAND</span> <span class="hljs-variable">${CMAKE_COMMAND}</span> -E echo <span class="hljs-string">"Binary: $&lt;TARGET_FILE:myapp&gt;"</span>
)
</code></pre>
<h3 id="debug-mode">Debug Mode</h3>
<p>Enable comprehensive debugging:</p>
<pre><code class="lang-cmake"><span class="hljs-comment"># Enable all debug output</span>
<span class="hljs-keyword">set</span>(HEIMDALL_DEBUG <span class="hljs-keyword">ON</span> CACHE BOOL <span class="hljs-string">"Enable debug output"</span>)
<span class="hljs-keyword">set</span>(HEIMDALL_SBOM_VERBOSE <span class="hljs-keyword">ON</span> CACHE BOOL <span class="hljs-string">"Enable verbose SBOM generation"</span>)

<span class="hljs-comment"># Check what was found</span>
<span class="hljs-keyword">message</span>(STATUS <span class="hljs-string">"Heimdall found: ${HEIMDALL_FOUND}"</span>)
<span class="hljs-keyword">message</span>(STATUS <span class="hljs-string">"LLD plugin: ${HEIMDALL_LLD_PLUGIN}"</span>)
<span class="hljs-keyword">message</span>(STATUS <span class="hljs-string">"Gold plugin: ${HEIMDALL_GOLD_PLUGIN}"</span>)
<span class="hljs-keyword">message</span>(STATUS <span class="hljs-string">"SBOM tool: ${HEIMDALL_SBOM_TOOL}"</span>)
</code></pre>
<h3 id="error-codes">Error Codes</h3>
<table>
<thead>
<tr>
<th>Exit Code</th>
<th>Meaning</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Plugin loading failed</td>
<td>Check plugin path and dependencies</td>
</tr>
<tr>
<td>2</td>
<td>Plugin initialization failed</td>
<td>Check plugin compatibility</td>
</tr>
<tr>
<td>3</td>
<td>Binary processing failed</td>
<td>Check binary file and permissions</td>
</tr>
<tr>
<td>4</td>
<td>Invalid arguments</td>
<td>Check CMake configuration</td>
</tr>
</tbody>
</table>
<h2 id="integration">Integration</h2>
<h3 id="with-other-cmake-modules">With Other CMake Modules</h3>
<h4 id="integration-with-cpack">Integration with CPack</h4>
<pre><code class="lang-cmake"><span class="hljs-comment"># Generate SBOM for packaging</span>
heimdall_enable_sbom(myapp FORMAT cyclonedx-<span class="hljs-number">1.6</span>)

<span class="hljs-comment"># Include SBOM in package</span>
<span class="hljs-keyword">install</span>(FILES <span class="hljs-variable">${CMAKE_BINARY_DIR}</span>/sbom/myapp.cyclonedx.json
        DESTINATION share/doc/myapp
        COMPONENT documentation)

<span class="hljs-comment"># CPack configuration</span>
<span class="hljs-keyword">set</span>(CPACK_PACKAGE_NAME <span class="hljs-string">"myapp"</span>)
<span class="hljs-keyword">set</span>(CPACK_GENERATOR <span class="hljs-string">"DEB"</span>)
</code></pre>
<h4 id="integration-with-testing">Integration with Testing</h4>
<pre><code class="lang-cmake"><span class="hljs-comment"># Generate SBOM for test targets</span>
<span class="hljs-keyword">add_executable</span>(unit_tests test_main.cpp)
heimdall_enable_sbom(unit_tests FORMAT spdx-<span class="hljs-number">2.3</span>)

<span class="hljs-comment"># Run tests and generate SBOM</span>
<span class="hljs-keyword">add_test</span>(NAME UnitTests <span class="hljs-keyword">COMMAND</span> unit_tests)
</code></pre>
<h3 id="with-external-tools">With External Tools</h3>
<h4 id="cyclonedx-tools">CycloneDX Tools</h4>
<pre><code class="lang-cmake"><span class="hljs-comment"># Generate CycloneDX SBOM</span>
heimdall_enable_sbom(myapp FORMAT cyclonedx-<span class="hljs-number">1.6</span>)

<span class="hljs-comment"># Validate with cyclonedx-cli</span>
<span class="hljs-keyword">add_custom_command</span>(<span class="hljs-keyword">TARGET</span> myapp POST_BUILD
    <span class="hljs-keyword">COMMAND</span> cyclonedx-cli validate <span class="hljs-variable">${CMAKE_BINARY_DIR}</span>/sbom/myapp.cyclonedx.json
    COMMENT <span class="hljs-string">"Validating CycloneDX SBOM"</span>
)
</code></pre>
<h4 id="spdx-tools">SPDX Tools</h4>
<pre><code class="lang-cmake"><span class="hljs-comment"># Generate SPDX SBOM</span>
heimdall_enable_sbom(myapp FORMAT spdx-<span class="hljs-number">3.0</span>)

<span class="hljs-comment"># Validate with SPDX tools</span>
<span class="hljs-keyword">add_custom_command</span>(<span class="hljs-keyword">TARGET</span> myapp POST_BUILD
    <span class="hljs-keyword">COMMAND</span> spdx-tools-validate <span class="hljs-variable">${CMAKE_BINARY_DIR}</span>/sbom/myapp.spdx.json
    COMMENT <span class="hljs-string">"Validating SPDX SBOM"</span>
)
</code></pre>
<h3 id="custom-scripts">Custom Scripts</h3>
<h4 id="sbom-processing-script">SBOM Processing Script</h4>
<pre><code class="lang-bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># process-sboms.sh</span>

BUILD_DIR=<span class="hljs-string">"<span class="hljs-variable">$1</span>"</span>
PROJECT_NAME=<span class="hljs-string">"<span class="hljs-variable">$2</span>"</span>

<span class="hljs-keyword">if</span> [ -z <span class="hljs-string">"<span class="hljs-variable">$BUILD_DIR</span>"</span> ] || [ -z <span class="hljs-string">"<span class="hljs-variable">$PROJECT_NAME</span>"</span> ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Usage: <span class="hljs-variable">$0</span> &lt;build_dir&gt; &lt;project_name&gt;"</span>
    <span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># Process all SBOMs in build directory</span>
find <span class="hljs-string">"<span class="hljs-variable">$BUILD_DIR</span>"</span> -name <span class="hljs-string">"*.spdx"</span> -o -name <span class="hljs-string">"*.cyclonedx.json"</span> | <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> sbom; <span class="hljs-keyword">do</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Processing: <span class="hljs-variable">$sbom</span>"</span>

    <span class="hljs-comment"># Validate SBOM</span>
    <span class="hljs-keyword">if</span> [[ <span class="hljs-string">"<span class="hljs-variable">$sbom</span>"</span> == *.json ]]; <span class="hljs-keyword">then</span>
        <span class="hljs-comment"># CycloneDX validation</span>
        cyclonedx-cli validate <span class="hljs-string">"<span class="hljs-variable">$sbom</span>"</span>
    <span class="hljs-keyword">else</span>
        <span class="hljs-comment"># SPDX validation</span>
        spdx-tools-validate <span class="hljs-string">"<span class="hljs-variable">$sbom</span>"</span>
    <span class="hljs-keyword">fi</span>

    <span class="hljs-comment"># Copy to project directory</span>
    cp <span class="hljs-string">"<span class="hljs-variable">$sbom</span>"</span> <span class="hljs-string">"./<span class="hljs-variable">$PROJECT_NAME</span>-<span class="hljs-subst">$(basename <span class="hljs-string">"<span class="hljs-variable">$sbom</span>"</span>)</span>"</span>
<span class="hljs-keyword">done</span>
</code></pre>
<h4 id="integration-in-cmake">Integration in CMake</h4>
<pre><code class="lang-cmake"><span class="hljs-comment"># Add custom target for SBOM processing</span>
<span class="hljs-keyword">add_custom_target</span>(process-sboms
    <span class="hljs-keyword">COMMAND</span> <span class="hljs-variable">${CMAKE_SOURCE_DIR}</span>/scripts/process-sboms.sh
            <span class="hljs-variable">${CMAKE_BINARY_DIR}</span>
            <span class="hljs-variable">${PROJECT_NAME}</span>
    DEPENDS myapp
    COMMENT <span class="hljs-string">"Processing generated SBOMs"</span>
)
</code></pre>
<h2 id="best-practices">Best Practices</h2>
<h3 id="configuration-management">Configuration Management</h3>
<ol>
<li><strong>Use Global Defaults</strong>: Set sensible defaults at the project level</li>
<li><strong>Override Per Target</strong>: Use target-specific properties for customization</li>
<li><strong>Conditional Generation</strong>: Only generate SBOMs when needed</li>
<li><strong>Version Control</strong>: Include SBOM configuration in version control</li>
</ol>
<h3 id="performance-optimization">Performance Optimization</h3>
<ol>
<li><strong>Selective Generation</strong>: Only generate SBOMs for release builds</li>
<li><strong>Format Selection</strong>: Choose appropriate format for your use case</li>
<li><strong>Dependency Scope</strong>: Use <code>INCLUDE_SYSTEM_LIBS OFF</code> when possible</li>
<li><strong>Parallel Builds</strong>: Ensure SBOM generation doesn't conflict with parallel builds</li>
</ol>
<h3 id="integration-guidelines">Integration Guidelines</h3>
<ol>
<li><strong>CI/CD Integration</strong>: Include SBOM generation in your CI/CD pipeline</li>
<li><strong>Validation</strong>: Validate generated SBOMs as part of your build process</li>
<li><strong>Documentation</strong>: Document your SBOM generation configuration</li>
<li><strong>Monitoring</strong>: Monitor SBOM generation success and failures</li>
</ol>
<h2 id="conclusion">Conclusion</h2>
<p>The Heimdall CMake module provides a powerful and flexible way to integrate SBOM generation into your CMake-based projects. With automatic detection, multiple format support, and extensive configuration options, it makes SBOM generation accessible to all C++ developers.</p>
<p>For more information, see:</p>
<ul>
<li><a href="heimdall-users-guide.md">Heimdall User Guide</a></li>
<li><a href="heimdall-sbom-manual.html">Heimdall SBOM Manual</a></li>
<li><a href="heimdall-validate-manual.html">Heimdall Validate Manual</a></li>
<li><a href="https://cyclonedx.org/specification/" target="_blank">CycloneDX Specification</a></li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="architecture.html" class="navigation navigation-prev " aria-label="Previous page: Architecture">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="heimdall-sbom-manual.html" class="navigation navigation-next " aria-label="Next page: Heimdall SBOM Manual">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"CMake Module","level":"1.3","depth":1,"next":{"title":"Heimdall SBOM Manual","level":"1.4","depth":1,"path":"docs/heimdall-sbom-manual.md","ref":"docs/heimdall-sbom-manual.md","articles":[]},"previous":{"title":"Architecture","level":"1.2","depth":1,"path":"docs/architecture.md","ref":"docs/architecture.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"docs/cmake_module.md","mtime":"2025-07-27T21:36:09.316Z","type":"markdown"},"gitbook":{"version":"4.0.8","time":"2025-07-27T21:36:16.340Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

